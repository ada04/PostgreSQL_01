***Запросы с занятия от 28/08/2025 Егор 

```pgsql
select * from flights f ;
select count(*) from flights f ; --214867
select count(actual_departure) from flights f ; --198519
select count(*) - count(actual_departure) from flights f ; --16348
select count(*) from flights f where f.actual_departure is null;
```

```pgsql
select max(actual_departure) from flights f ;
select * from flights f where f.actual_departure > '2017-08-15 17:55';
```

```pgsql
select * from flights f where f.actual_departure >= (select max(actual_departure) from flights f);
```

```pgsql
select * from aircrafts a ;
```

```pgsql
select distinct aircraft_code from flights f ;
select count(aircraft_code) from flights f where f.aircraft_code ='319'; --8032
```

```pgsql
select f.aircraft_code,  count(f.aircraft_code)  
from flights f 
group by f.aircraft_code
order by 1;
```

```pgsql
select f.aircraft_code, f.departure_airport,  count(f.aircraft_code)  
from flights f 
group by f.aircraft_code, f.departure_airport
order by 1;
```

```pgsql
select f.aircraft_code, f.departure_airport,  count(f.aircraft_code) as cnt 
from flights f 
group by f.aircraft_code, f.departure_airport
having count(f.aircraft_code) > 1000
order by 1;
```

```pgsql
select f.aircraft_code, f.departure_airport,  count(f.aircraft_code) as cnt 
from flights f 
where f.departure_airport = 'DME'
group by f.aircraft_code, f.departure_airport
having count(f.aircraft_code) > 1000
order by 1;
```

```pgsql
select f.aircraft_code, f.departure_airport,  count(f.aircraft_code) as cnt 
from flights f 
where f.departure_airport = 'DME'
group by f.aircraft_code, f.departure_airport
having count(f.aircraft_code) > 1000
order by 3 desc 
limit 3;
```

```pgsql
select f.departure_airport, count(f.departure_airport)
from flights f 
group by f.departure_airport 
order by 2 desc;
```

```pgsql
select f.departure_airport, f.scheduled_departure,  count(f.departure_airport)
from flights f 
group by f.departure_airport, f.scheduled_departure 
order by 2 desc;
```

```pgsql
select f.departure_airport, to_char(f.scheduled_departure, 'YYYY'),  count(f.departure_airport)
from flights f 
group by f.departure_airport, to_char(f.scheduled_departure, 'YYYY') 
order by 2 desc;
```

```pgsql
select a.model,  count(f.aircraft_code)  
from flights f, aircrafts a 
where a.aircraft_code = f.aircraft_code 
group by a.model 
order by 1;
```

```pgsql
select * from aircrafts_data ad ;
```

```pgsql
select * 
from aircrafts a,   seats s
where a.aircraft_code = 'CN1';
```

```pgsql
select * 
from aircrafts a,   seats s
where a.aircraft_code = s.aircraft_code 
  and a.aircraft_code = 'CN1';
```

```pgsql
select * 
from aircrafts a natural JOIN seats s 
where a.aircra = 'CN1';
```

```pgsql
select * 
from aircrafts a JOIN seats s using (aircraft_code)
where a.aircraft_code = 'CN1';
```

```pgsql
select * 
from aircrafts a JOIN seats s on a.aircraft_code = s.aircraft_code
where a.aircraft_code = 'CN1';
```

```pgsql
select model,  flight_no 
from aircrafts a left join flights f on (a.aircraft_code = f.aircraft_code) 
where to_char(f.scheduled_departure,'DD-MM-YYYY HH24:MI') = '14-09-2017 10:15'
order by 1;
```

```pgsql
select a.model, f.flight_no, f.scheduled_departure 
from aircrafts a left join flights f using (aircraft_code)
where to_char(f.scheduled_departure,'DD-MM-YYYY HH24:MI') = '14-09-2017 10:15'
order by 1;
```

```pgsql
select model,  flight_no 
from aircrafts a, flights f  
where to_char(f.scheduled_departure,'DD-MM-YYYY HH24:MI') = '14-09-2017 10:15'
  and a.aircraft_code = f.aircraft_code
order by 1;
```

```pgsql
select a.model, f.flight_no, f.scheduled_departure 
from flights f right join aircrafts a using (aircraft_code)
where to_char(f.scheduled_departure,'DD-MM-YYYY HH24:MI') = '14-09-2017 10:15'
order by 1;
```
