### Урок 12 - Практика...

#### 1

10 бронирований с максимальной стоимостью

```pgsql
select * from bookings order by total_amount desc limit 10;
```

10 самых дорогих билетов (цена, имя пассажира, рейс)

```pgsql
select tf.flight_id, tf.amount, t.passenger_name 
from ticket_flights tf, tickets t
where tf.ticket_no = t.ticket_no
order by amount desc limit 10;
```

Список пассажиров, вылетающих рейсом (имя, место) flight_id = 42420

```pgsql
select t.passenger_name, bp.seat_no 
from tickets t, ticket_flights tf, boarding_passes bp
where t.ticket_no = tf.ticket_no
and tf.ticket_no = bp.ticket_no
and tf.flight_id = bp.flight_id 
and tf.flight_id = 42420;
```

Список билетов в одном бронировании (номер бронирования, дата, имя пассажира, номер рейса, дата вылета, откуда, куда)

```pgsql
-- 7CD7DE, 77302F, 88C866
select b.book_ref, b.book_date, t.passenger_name, f.flight_no, f.scheduled_departure,
(select ad.city -> 'ru' from airports_data ad where ad.airport_code = f.departure_airport) as "depature airport",
(select ad.city -> 'ru' from airports_data ad where ad.airport_code = f.arrival_airport) as "arrival airport"
from bookings b, tickets t, ticket_flights tf, flights f  
where b.book_ref = t.book_ref
and t.ticket_no = tf.ticket_no 
and tf.flight_id = f.flight_id
and b.book_ref = '7CD7DE';

select b.book_ref, b.book_date, t.passenger_name, f.flight_no, f.scheduled_departure,
da.city, aa.city
from bookings b, tickets t, ticket_flights tf, flights f, airports da , airports aa 
where b.book_ref = t.book_ref
and t.ticket_no = tf.ticket_no 
and tf.flight_id = f.flight_id
and b.book_ref = '7CD7DE'
and f.departure_airport = da.airport_code 
  and f.arrival_airport = aa.airport_code;
```

"Табло аэропорта" на определенную дату (рейс, время, тип судна, вылет/прилет, в/из город)

```pgsql
```
